<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>All‑in‑One Video Caption & Subtitle Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />  <!-- Tailwind -->  <script src="https://cdn.tailwindcss.com"></script>  <!-- FFmpeg WASM -->  <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.12.6/dist/ffmpeg.min.js"></script>  <style>
    body { background:#020617 }
    video { max-height: 420px }
    .overlay { position:absolute; bottom:12%; width:100%; text-align:center; pointer-events:none }
    .word { display:inline-block; padding:0 .15em; opacity:.35; transition:all .15s }
    .word.active { opacity:1; transform:scale(1.15) }
  </style></head>
<body class="text-zinc-100 p-6"><h1 class="text-3xl font-bold mb-6">Video Subtitle / Caption Generator</h1><div class="grid xl:grid-cols-2 gap-6"><!-- LEFT COLUMN --><div class="space-y-4">
  <input id="videoInput" type="file" accept="video/*" class="block" />  <div class="relative">
    <video id="video" controls class="w-full rounded"></video>
    <div id="overlay" class="overlay text-3xl font-extrabold"></div>
  </div>  <div class="bg-zinc-900 p-4 rounded">
    <h2 class="font-semibold mb-2">Timeline Caption Editor</h2>
    <div id="timeline" class="space-y-2 max-h-64 overflow-y-auto"></div>
  </div>
</div><!-- RIGHT COLUMN --><div class="space-y-4">  <button onclick="mockWhisper()" class="bg-indigo-600 px-4 py-2 rounded w-full">
    Generate Captions (Whisper‑Ready)
  </button>  <textarea id="fullText" rows="4" class="w-full bg-zinc-900 p-3 rounded" placeholder="Full transcript"></textarea>  <div class="grid grid-cols-2 gap-3">
    <select id="preset" onchange="applyPreset()" class="bg-zinc-900 p-2 rounded">
      <option value="mrbeast">MrBeast</option>
      <option value="hormozi">Alex Hormozi</option>
      <option value="podcast">Podcast</option>
      <option value="meme">Meme</option>
    </select><select id="lang" class="bg-zinc-900 p-2 rounded">
  <option>English</option>
  <option>Spanish</option>
  <option>French</option>
  <option>German</option>
</select>

  </div>  <button onclick="exportSRT()" class="bg-emerald-600 px-4 py-2 rounded w-full">
    Export SRT
  </button>  <button onclick="burnCaptions()" class="bg-red-600 px-4 py-2 rounded w-full">
    Burn Captions Into Video
  </button><a id="download" class="hidden underline text-blue-400">Download Video</a>

</div>
</div><script>
let captions = [];
let ffmpeg;

const video = document.getElementById('video');
const overlay = document.getElementById('overlay');
const timeline = document.getElementById('timeline');

/* ================= VIDEO LOAD ================= */
document.getElementById('videoInput').onchange = e => {
  video.src = URL.createObjectURL(e.target.files[0]);
};

/* ================= MOCK WHISPER (NO ERRORS) ================= */
function mockWhisper(){
  captions = [
    { start:0, end:2.2, text:'This caption tool is built for creators' },
    { start:2.2, end:4.8, text:'Word by word subtitles increase retention' },
    { start:4.8, end:7.5, text:'This works for TikTok Reels and Shorts' }
  ];

  fullText.value = captions.map(c=>c.text).join(' ');
  renderTimeline();
}

/* ================= TIMELINE ================= */
function renderTimeline(){
  timeline.innerHTML = '';
  captions.forEach((c,i)=>{
    timeline.innerHTML += `
      <div class="bg-zinc-800 p-2 rounded">
        <div class="text-xs opacity-70">${c.start}s → ${c.end}s</div>
        <input class="w-full bg-zinc-900 p-1 mt-1" value="${c.text}"
          onchange="captions[${i}].text=this.value">
      </div>`;
  });
}

/* ================= WORD‑BY‑WORD RENDER ================= */
video.ontimeupdate = () => {
  const t = video.currentTime;
  const cap = captions.find(c => t >= c.start && t <= c.end);

  if(!cap){ overlay.innerHTML=''; return; }

  overlay.innerHTML = cap.text.split(' ').map(w =>
    `<span class="word active">${w}</span>`
  ).join(' ');
};

/* ================= PRESETS ================= */
function applyPreset(){
  overlay.className = 'overlay';

  if(preset.value==='mrbeast')
    overlay.classList.add('text-yellow-400','uppercase','drop-shadow-xl');

  if(preset.value==='hormozi')
    overlay.classList.add('text-white','tracking-widest');

  if(preset.value==='podcast')
    overlay.classList.add('text-green-400','font-serif');

  if(preset.value==='meme')
    overlay.classList.add('text-red-400','italic');
}

/* ================= EXPORT SRT ================= */
function exportSRT(){
  let out='';
  captions.forEach((c,i)=>{
    out += `${i+1}\n00:00:${c.start.toFixed(2)} --> 00:00:${c.end.toFixed(2)}\n${c.text}\n\n`;
  });

  const blob = new Blob([out],{type:'text/plain'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'captions.srt';
  a.click();
}

/* ================= BURN CAPTIONS ================= */
async function burnCaptions(){
  if(!videoInput.files[0]) return alert('Upload a video first');

  if(!ffmpeg){
    ffmpeg = new FFmpeg();
    await ffmpeg.load({ coreURL:'https://unpkg.com/@ffmpeg/core@0.12.6/dist/ffmpeg-core.js' });
  }

  await ffmpeg.writeFile('in.mp4', await fetchFile(videoInput.files[0]));

  const text = captions.map(c=>c.text).join(' ')
    .replace(/'/g,"\\'");

  await ffmpeg.exec([
    '-i','in.mp4',
    '-vf',`drawtext=text='${text}':fontsize=32:fontcolor=white:x=(w-text_w)/2:y=h-120:box=1:boxcolor=black@0.6`,
    '-codec:a','copy','out.mp4'
  ]);

  const data = await ffmpeg.readFile('out.mp4');
  const url = URL.createObjectURL(new Blob([data.buffer],{type:'video/mp4'}));

  download.href = url;
  download.classList.remove('hidden');
}
</script></body>
</html>
